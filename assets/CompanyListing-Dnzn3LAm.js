import{d as f,r as k,j as e,B as c,F as i,T as g,_ as d}from"./index-CyrJaVhS.js";import{A as T,D as q}from"./AlertModal-Cc2abRNZ.js";import{u as v,z as w,b as S,a as F,t as D,M as E,I as B}from"./index-C6klRg22.js";import{u as b,a as x}from"./axiosInstance-DEpY0Rne.js";import{T as I}from"./TextInput-YpIo0TZ0.js";import{B as u}from"./Button-BujI3Ifw.js";import{I as Q}from"./IconEdit-CEWE5dIW.js";import{u as A}from"./useGetAllCompanies-BlAH-OIU.js";import{I as L}from"./IconPlus-CFDQgyHZ.js";const M=n=>{const s=f();return b({mutationFn:async t=>{await x.post(`/companies-update/${n}`,t)},onSuccess:()=>{s.invalidateQueries(["companies"])}})},P=n=>v({queryKey:["company",n],queryFn:async()=>await(await x.get(`/companies/${n}`)).data.company,enabled:!!n}),z=w.object({name:w.string().min(1,"name is required")}),N=({id:n})=>{const[s,{open:t,close:a}]=S(!1),{data:o}=P(n),{mutate:l,isPending:r}=M(n),{register:j,handleSubmit:C,setValue:p}=F({resolver:D(z)}),y=h=>{const m=new FormData;m.append("name",h.name),l(m,{onSuccess:()=>{a(),d.success("Company updated Successfully.")},onError:()=>{d.error("Something went wrong.")}})};return k.useEffect(()=>{p("name",o==null?void 0:o.name)},[o,p]),e.jsxs(c,{children:[e.jsx(E,{opened:s,onClose:a,title:"Edit Company Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(c,{my:10,children:e.jsxs("form",{onSubmit:C(y),children:[e.jsxs(i,{align:"center",gap:"lg",children:[e.jsx(g,{fw:500,children:"Name"}),e.jsx(I,{style:{width:"100%"},placeholder:"Enter company name",...j("name")})]}),e.jsxs(i,{justify:"end",gap:15,mt:20,children:[e.jsx(u,{radius:4,size:"sm",onClick:a,color:"dark",children:"Cancel"}),e.jsx(u,{type:"submit",radius:4,size:"sm",loading:r,disabled:r,color:"blue",children:"Update"})]})]})})}),e.jsx(Q,{onClick:t,style:{color:"#4361ee",cursor:"pointer"}})]})},$=()=>{const n=f();return b({mutationFn:async s=>await x.delete(`/companies-delete/${s}`),onSuccess:()=>{n.invalidateQueries(["companies"])}})},G=({id:n})=>{const[s,{open:t,close:a}]=S(!1),{mutate:o,isPending:l}=$(),r=()=>{o(n,{onSuccess:()=>{a(),d.success("Company deleted successfully.")}})};return e.jsxs(c,{children:[e.jsx(T,{isLoading:l,title:"Company Delete",description:"This action cannot be undone.",opened:s,close:a,onConfirm:r}),e.jsx(B,{onClick:t,style:{color:"#ef233c",cursor:"pointer"}})]})},U=()=>[{name:"Id",selector:s=>s.id,width:"100px"},{name:"Name",selector:s=>s.name,width:"500px"},{name:"Actions",cell:s=>e.jsxs(i,{align:"center",gap:20,children:[e.jsx(N,{id:s.id}),e.jsx(G,{id:s.id})]})}],W=()=>{const n=f();return b({mutationFn:async s=>{await x.post("/company-create",s)},onSuccess:()=>{n.invalidateQueries(["companies"])}})},_=()=>{var y;const[n,{open:s,close:t}]=S(!1),{mutate:a,isPending:o}=W(),{register:l,handleSubmit:r,reset:j,formState:{errors:C}}=F({resolver:D(z)}),p=h=>{const m=new FormData;m.append("name",h.name),a(m,{onSuccess:()=>{j(),t(),d.success("Company created Successfully.")},onError:()=>{d.error("Something went wrong.")}})};return e.jsxs(c,{children:[e.jsx(E,{opened:n,onClose:t,title:"Create Company Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(c,{my:10,children:e.jsxs("form",{onSubmit:r(p),children:[e.jsxs(i,{align:"center",gap:"lg",children:[e.jsx(g,{fw:500,children:"Name"}),e.jsx(I,{style:{width:"100%"},placeholder:"Enter company name",...l("name"),error:(y=C.name)==null?void 0:y.message})]}),e.jsxs(i,{justify:"end",gap:15,mt:20,children:[e.jsx(u,{radius:4,size:"sm",onClick:t,color:"dark",children:"Cancel"}),e.jsx(u,{type:"submit",radius:4,size:"sm",loading:o,disabled:o,color:"blue",children:"Create"})]})]})})}),e.jsx(i,{justify:"end",children:e.jsx(u,{onClick:s,leftSection:e.jsx(L,{size:16}),children:"Create"})})]})},K=()=>{const n=U(),{data:s,isLoading:t}=A();return e.jsxs(c,{children:[e.jsx(_,{}),t?e.jsx(g,{children:"loading..."}):e.jsx(q,{columns:n,data:s})]})},se=()=>e.jsx(K,{});export{se as default};

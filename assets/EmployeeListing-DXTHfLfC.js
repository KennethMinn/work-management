import{w as Q,i as W,k as J,x as Ue,j as e,U as Fe,m as X,D as Y,H as de,y as ze,E as ce,B as L,J as me,A as M,C as V,K as pe,M as Ae,d as Z,r as D,N as ee,F as d,T as g,G as O,_ as T}from"./index-CdaNCSdy.js";import{A as qe,D as De}from"./AlertModal-BALMEkv9.js";import{z as x,u as Ge,b as re,a as ue,t as he,M as ge,C as q,I as Le}from"./index-BGfJnqRX.js";import{u as xe}from"./useGetAllDepartments-DHpPH1Ao.js";import{u as je}from"./useGetAllCompanies-BRZegP1x.js";import{u as ye}from"./useGetAllPositions-DPJEFSg0.js";import{c as fe,I as we,u as se,a as K}from"./axiosInstance-CV4y__Ky.js";import{S as ve}from"./Stack-BBUnv7TG.js";import{F as be,I as Ce}from"./IconCloudUpload-CPjL5E1p.js";import{B as G}from"./Button-Clsx1tHw.js";import{T as N}from"./TextInput-BSExqZ5H.js";import{P as _e}from"./PasswordInput-D0PXG41E.js";import{I as Ne,g as Se,a as $e}from"./InputsGroupFieldset-QsHuf5Z8.js";import{S as $}from"./Select-Cd5n2TYT.js";import{I as Te}from"./IconEdit-j-UlcBOZ.js";import{u as Be}from"./useGetAllEmployees-BWaIcvRP.js";import{I as Me}from"./IconPlus-BCNZ26AQ.js";import"./ActionIcon-BZbRPvMN.js";const[Ve,Re]=fe(),[Oe,Qe]=fe();var Ee={card:"m_9dc8ae12"};const We={withBorder:!0},Ke=X((n,{radius:r})=>({card:{"--card-radius":Y(r)}})),ne=Q((n,r)=>{const a=W("RadioCard",We,n),{classNames:p,className:o,style:f,styles:h,unstyled:l,vars:C,checked:R,mod:_,withBorder:E,value:v,onClick:P,name:w,onKeyDown:k,...U}=a,I=J({name:"RadioCard",classes:Ee,props:a,className:o,style:f,classNames:p,styles:h,unstyled:l,vars:C,varsResolver:Ke,rootSelector:"card"}),{dir:m}=Ue(),c=Re(),j=typeof R=="boolean"?R:(c==null?void 0:c.value)===v||!1,F=w||(c==null?void 0:c.name),A=y=>{if(k==null||k(y),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(y.nativeEvent.code)){y.preventDefault();const b=Array.from(document.querySelectorAll(`[role="radio"][name="${F||"__mantine"}"]`)),t=b.findIndex(u=>u===y.target),i=t+1>=b.length?0:t+1,s=t-1<0?b.length-1:t-1;y.nativeEvent.code==="ArrowDown"&&(b[i].focus(),b[i].click()),y.nativeEvent.code==="ArrowUp"&&(b[s].focus(),b[s].click()),y.nativeEvent.code==="ArrowLeft"&&(b[m==="ltr"?s:i].focus(),b[m==="ltr"?s:i].click()),y.nativeEvent.code==="ArrowRight"&&(b[m==="ltr"?i:s].focus(),b[m==="ltr"?i:s].click())}};return e.jsx(Oe,{value:{checked:j},children:e.jsx(Fe,{ref:r,mod:[{"with-border":E,checked:j},_],...I("card"),...U,role:"radio","aria-checked":j,name:F,onClick:y=>{P==null||P(y),c==null||c.onChange(v||"")},onKeyDown:A})})});ne.displayName="@mantine/core/RadioCard";ne.classes=Ee;const He={},oe=Q((n,r)=>{const{value:a,defaultValue:p,onChange:o,size:f,wrapperProps:h,children:l,name:C,readOnly:R,..._}=W("RadioGroup",He,n),E=de(C),[v,P]=ze({value:a,defaultValue:p,finalValue:"",onChange:o}),w=k=>!R&&P(typeof k=="string"?k:k.currentTarget.value);return e.jsx(Ve,{value:{value:v,onChange:w,size:f,name:E},children:e.jsx(we.Wrapper,{size:f,ref:r,...h,..._,labelElement:"div",__staticSelector:"RadioGroup",children:e.jsx(Ne,{role:"radiogroup",children:l})})})});oe.classes=we.Wrapper.classes;oe.displayName="@mantine/core/RadioGroup";function Pe({size:n,style:r,...a}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 5 5",style:{width:ce(n),height:ce(n),...r},"aria-hidden":!0,...a,children:e.jsx("circle",{cx:"2.5",cy:"2.5",r:"2.5",fill:"currentColor"})})}var ke={indicator:"m_717d7ff6",icon:"m_3e4da632","indicator--outline":"m_2980836c"};const Je={icon:Pe},Xe=X((n,{radius:r,color:a,size:p,iconColor:o,variant:f,autoContrast:h})=>{const l=me({color:a||n.primaryColor,theme:n}),C=l.isThemeColor&&l.shade===void 0?`var(--mantine-color-${l.color}-outline)`:l.color;return{indicator:{"--radio-size":M(p,"radio-size"),"--radio-radius":r===void 0?void 0:Y(r),"--radio-color":f==="outline"?C:V(a,n),"--radio-icon-size":M(p,"radio-icon-size"),"--radio-icon-color":o?V(o,n):Se(h,n)?pe({color:a,theme:n,autoContrast:h}):void 0}}}),ae=Q((n,r)=>{const a=W("RadioIndicator",Je,n),{classNames:p,className:o,style:f,styles:h,unstyled:l,vars:C,icon:R,radius:_,color:E,iconColor:v,autoContrast:P,checked:w,mod:k,variant:U,disabled:I,...m}=a,c=R,j=J({name:"RadioIndicator",classes:ke,props:a,className:o,style:f,classNames:p,styles:h,unstyled:l,vars:C,varsResolver:Xe,rootSelector:"indicator"}),F=Qe(),A=typeof w=="boolean"?w:(F==null?void 0:F.checked)||!1;return e.jsx(L,{ref:r,...j("indicator",{variant:U}),variant:U,mod:[{checked:A,disabled:I},k],...m,children:e.jsx(c,{...j("icon")})})});ae.displayName="@mantine/core/RadioIndicator";ae.classes=ke;var Ie={root:"m_f3f1af94",inner:"m_89c4f5e4",icon:"m_f3ed6b2b",radio:"m_8a3dbb89","radio--outline":"m_1bfe9d39"};const Ye={labelPosition:"right"},Ze=X((n,{size:r,radius:a,color:p,iconColor:o,variant:f,autoContrast:h})=>{const l=me({color:p||n.primaryColor,theme:n}),C=l.isThemeColor&&l.shade===void 0?`var(--mantine-color-${l.color}-outline)`:l.color;return{root:{"--radio-size":M(r,"radio-size"),"--radio-radius":a===void 0?void 0:Y(a),"--radio-color":f==="outline"?C:V(p,n),"--radio-icon-color":o?V(o,n):Se(h,n)?pe({color:p,theme:n,autoContrast:h}):void 0,"--radio-icon-size":M(r,"radio-icon-size")}}}),z=Q((n,r)=>{const a=W("Radio",Ye,n),{classNames:p,className:o,style:f,styles:h,unstyled:l,vars:C,id:R,size:_,label:E,labelPosition:v,description:P,error:w,radius:k,color:U,variant:I,disabled:m,wrapperProps:c,icon:j=Pe,rootRef:F,iconColor:A,onChange:y,mod:b,...t}=a,i=J({name:"Radio",classes:Ie,props:a,className:o,style:f,classNames:p,styles:h,unstyled:l,vars:C,varsResolver:Ze}),s=Re(),u=(s==null?void 0:s.size)??_,S=a.size?_:u,{styleProps:B,rest:H}=Ae(t),te=de(R),ie=s?{checked:s.value===H.value,name:H.name??s.name,onChange:le=>{s.onChange(le),y==null||y(le)}}:{};return e.jsx($e,{...i("root"),__staticSelector:"Radio",__stylesApiProps:a,id:te,size:S,labelPosition:v,label:E,description:P,error:w,disabled:m,classNames:p,styles:h,unstyled:l,"data-checked":ie.checked||void 0,variant:I,ref:F,mod:b,...B,...c,children:e.jsxs(L,{...i("inner"),mod:{"label-position":v},children:[e.jsx(L,{...i("radio",{focusable:!0,variant:I}),onChange:y,...H,...ie,component:"input",mod:{error:!!w},ref:r,id:te,disabled:m,type:"radio"}),e.jsx(j,{...i("icon"),"aria-hidden":!0})]})})});z.classes=Ie;z.displayName="@mantine/core/Radio";z.Group=oe;z.Card=ne;z.Indicator=ae;const er=x.object({name:x.string().min(1,"name is required"),email:x.string().email("invalid email"),password:x.string().min(6,"password must be at least 6 characters"),phone:x.string().min(1,"phone is required"),nrc_number:x.string().min(1,"nrc is required"),gender:x.string().min(1,"gender is required"),role:x.string().min(1,"role is required"),company_id:x.string().min(1,"department is required"),department_id:x.string().min(1,"position is required"),position_id:x.string().min(1,"position is required")}),rr=x.object({name:x.string().min(1,"name is required"),email:x.string().email("invalid email"),password:x.string().optional(),phone:x.string().min(1,"phone is required"),nrc_number:x.string().min(1,"nrc is required"),gender:x.string().min(1,"gender is required"),role:x.string().min(1,"role is required"),company_id:x.string().min(1,"department is required"),department_id:x.string().min(1,"position is required"),position_id:x.string().min(1,"position is required")}),sr=n=>{const r=Z();return se({mutationFn:async a=>{await K.post(`/employees-update/${n}`,a)},onSuccess:()=>{r.invalidateQueries(["employees"])}})},nr=n=>Ge({queryKey:["employee",n],queryFn:async()=>await(await K.get(`/employees/${n}`)).data.employee,enabled:!!n}),or=({id:n})=>{var A,y,b,t,i;const[r,{open:a,close:p}]=re(!1),{data:o}=nr(n),{mutate:f,isPending:h}=sr(n),{data:l}=xe(),{data:C}=je(),{data:R}=ye(),[_,E]=D.useState(null),[v,P]=D.useState(null),w=D.useRef(null),k=()=>{var s;P(null),(s=w.current)==null||s.call(w)},{register:U,handleSubmit:I,control:m,setValue:c,formState:{errors:j}}=ue({resolver:he(rr),defaultValues:{gender:"Male"}}),F=s=>{const u={...s,photo_path:v},S=new FormData;for(const B in u)S.append(B,u[B]);f(S,{onSuccess:()=>{p(),P(null),T.success("Employee Updated Successfully.")},onError:()=>{T.error("Something went wrong.")}})};return D.useEffect(()=>{if(v){const s=URL.createObjectURL(v);return E(s),()=>URL.revokeObjectURL(s)}else o!=null&&o.imgURL?E(o.imgURL):E(null)},[v,o==null?void 0:o.imgURL]),D.useEffect(()=>{var s,u,S;o&&(E(o.imgURL||null),c("name",o.name),c("email",o.email),c("phone",o.phone),c("nrc_number",o.nrc_number),c("gender",o.gender),c("role",o.role),c("company_id",(s=o.company_id)==null?void 0:s.toString()),c("department_id",(u=o.department_id)==null?void 0:u.toString()),c("position_id",(S=o.position_id)==null?void 0:S.toString()))},[o,c]),e.jsxs(L,{children:[e.jsx(ge,{size:650,padding:30,opened:r,onClose:p,title:"Edit Employee Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(L,{my:10,children:e.jsxs("form",{onSubmit:I(F),children:[e.jsxs(ve,{gap:20,children:[_&&e.jsx(ee,{mb:30,src:_,w:150,h:150,radius:"100%",alt:"avatar"}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Profile"}),e.jsxs(O,{style:{width:"100%"},children:[e.jsx(be,{resetRef:w,onChange:P,accept:"image/png,image/jpeg",children:s=>e.jsx(G,{leftSection:e.jsx(Ce,{}),...s,children:"Upload image"})}),e.jsx(G,{disabled:!v,color:"red",onClick:k,children:"Reset"})]})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Name"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter employee name",...U("name"),error:(A=j.name)==null?void 0:A.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Email"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter email",...U("email"),error:(y=j.email)==null?void 0:y.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Password"}),e.jsx(_e,{style:{width:"100%"},placeholder:"Enter password",...U("password"),error:(b=j.password)==null?void 0:b.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"phone"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter phone",...U("phone"),error:(t=j.phone)==null?void 0:t.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"nrc number"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter nrc number",...U("nrc_number"),error:(i=j.nrc_number)==null?void 0:i.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Gender"}),e.jsx(q,{name:"gender",control:m,render:({field:s})=>e.jsx(z.Group,{...s,style:{width:"100%"},children:e.jsxs(O,{children:[e.jsx(z,{value:"male",label:"Male"}),e.jsx(z,{value:"female",label:"Female"})]})})})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Role"}),e.jsx(q,{name:"role",control:m,render:({field:s})=>{var u;return e.jsx($,{style:{width:"100%"},placeholder:"Pick role",data:["admin","employee"],...s,error:(u=j.role)==null?void 0:u.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Company"}),e.jsx(q,{name:"company_id",control:m,render:({field:s})=>{var u;return e.jsx($,{style:{width:"100%"},placeholder:"Pick company",data:C==null?void 0:C.map(S=>({label:S.name,value:S.id.toString()})),...s,error:(u=j.company_id)==null?void 0:u.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Department"}),e.jsx(q,{name:"department_id",control:m,render:({field:s})=>{var u;return e.jsx($,{style:{width:"100%"},placeholder:"Pick department",data:l==null?void 0:l.map(S=>({label:S.name,value:S.id.toString()})),...s,error:(u=j.department_id)==null?void 0:u.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Position"}),e.jsx(q,{name:"position_id",control:m,render:({field:s})=>{var u;return e.jsx($,{style:{width:"100%"},placeholder:"Pick position",data:R==null?void 0:R.map(S=>({label:S.name,value:S.id.toString()})),...s,error:(u=j.position_id)==null?void 0:u.message})}})]})]}),e.jsxs(d,{justify:"end",gap:15,mt:20,children:[e.jsx(G,{radius:4,size:"sm",onClick:p,color:"dark",children:"Cancel"}),e.jsx(G,{type:"submit",radius:4,size:"sm",loading:h,disabled:h,color:"blue",children:"Update"})]})]})})}),e.jsx(Te,{onClick:a,style:{color:"#4361ee",cursor:"pointer"}})]})},ar=()=>{const n=Z();return se({mutationFn:async r=>await K.delete(`/employees-delete/${r}`),onSuccess:()=>{n.invalidateQueries(["employees "])}})},tr=({id:n})=>{const[r,{open:a,close:p}]=re(!1),{mutate:o,isPending:f}=ar(),h=()=>{o(n,{onSuccess:()=>{p(),T.success("Employee deleted successfully.")}})};return e.jsxs(L,{children:[e.jsx(qe,{isLoading:f,title:"Employee Delete",description:"This action cannot be undone.",opened:r,close:p,onConfirm:h}),e.jsx(Le,{onClick:a,style:{color:"#ef233c",cursor:"pointer"}})]})},ir=()=>[{name:"Id",selector:r=>r.id,width:"100px"},{name:"Avatar",cell:r=>e.jsx(ee,{src:r.imgURL}),width:"100px"},{name:"Name",selector:r=>r.name??"-",width:"160px"},{name:"Gender",selector:r=>r.gender??"-"},{name:"Email",selector:r=>r.email??"-"},{name:"Phone",selector:r=>r.phone??"-"},{name:"Position",selector:r=>{var a;return((a=r==null?void 0:r.position)==null?void 0:a.name)??"-"}},{name:"Role",selector:r=>r.role??"-"},{name:"Actions",cell:r=>e.jsxs(d,{align:"center",gap:20,children:[e.jsx(or,{id:r.id}),e.jsx(tr,{id:r.id})]})}],lr=()=>{const n=Z();return se({mutationFn:async r=>{await K.post("/employee-create",r)},onSuccess:()=>{n.invalidateQueries(["employees"])}})},cr=()=>{var j,F,A,y,b;const[n,{open:r,close:a}]=re(!1),{mutate:p,isPending:o}=lr(),{data:f}=xe(),{data:h}=je(),{data:l}=ye(),[C,R]=D.useState(null),[_,E]=D.useState(null),v=D.useRef(null),P=()=>{var t;E(null),(t=v.current)==null||t.call(v)},{register:w,handleSubmit:k,reset:U,control:I,formState:{errors:m}}=ue({resolver:he(er),defaultValues:{gender:"Male"}});D.useEffect(()=>{if(_){const t=URL.createObjectURL(_);return R(t),()=>URL.revokeObjectURL(t)}else R(null)},[_]);const c=t=>{if(!_){T.error("Please Add profile");return}const i={...t,photo_path:_},s=new FormData;for(const u in i)s.append(u,i[u]);p(s,{onSuccess:()=>{U(),a(),E(null),T.success("Employee Created Successfully.")},onError:()=>{T.error("Something went wrong.")}})};return e.jsxs(L,{children:[e.jsx(ge,{size:650,padding:30,opened:n,onClose:a,title:"Create Employee Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(L,{my:10,children:e.jsxs("form",{onSubmit:k(c),children:[e.jsxs(ve,{gap:20,children:[C&&e.jsx(ee,{mb:30,src:C,w:150,h:150,radius:"100%",alt:"avatar"}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Profile"}),e.jsxs(O,{style:{width:"100%"},children:[e.jsx(be,{resetRef:v,onChange:E,accept:"image/png,image/jpeg",children:t=>e.jsx(G,{leftSection:e.jsx(Ce,{}),...t,children:"Upload image"})}),e.jsx(G,{disabled:!_,color:"red",onClick:P,children:"Reset"})]})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Name"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter employee name",...w("name"),error:(j=m.name)==null?void 0:j.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Email"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter email",...w("email"),error:(F=m.email)==null?void 0:F.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Password"}),e.jsx(_e,{style:{width:"100%"},placeholder:"Enter password",...w("password"),error:(A=m.password)==null?void 0:A.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"phone"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter phone",...w("phone"),error:(y=m.phone)==null?void 0:y.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"nrc number"}),e.jsx(N,{style:{width:"100%"},placeholder:"Enter nrc number",...w("nrc_number"),error:(b=m.nrc_number)==null?void 0:b.message})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Gender"}),e.jsx(q,{name:"gender",control:I,render:({field:t})=>e.jsx(z.Group,{...t,style:{width:"100%"},children:e.jsxs(O,{children:[e.jsx(z,{value:"Male",label:"Male"}),e.jsx(z,{value:"Female",label:"Female"})]})})})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Role"}),e.jsx(q,{name:"role",control:I,render:({field:t})=>{var i;return e.jsx($,{style:{width:"100%"},placeholder:"Pick role",data:["admin","employee"],...t,error:(i=m.role)==null?void 0:i.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Company"}),e.jsx(q,{name:"company_id",control:I,render:({field:t})=>{var i;return e.jsx($,{style:{width:"100%"},placeholder:"Pick company",data:h==null?void 0:h.map(s=>({label:s.name,value:s.id.toString()})),...t,error:(i=m.company_id)==null?void 0:i.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Department"}),e.jsx(q,{name:"department_id",control:I,render:({field:t})=>{var i;return e.jsx($,{style:{width:"100%"},placeholder:"Pick department",data:f==null?void 0:f.map(s=>({label:s.name,value:s.id.toString()})),...t,error:(i=m.department_id)==null?void 0:i.message})}})]}),e.jsxs(d,{align:"center",gap:"lg",children:[e.jsx(g,{w:130,fw:500,children:"Position"}),e.jsx(q,{name:"position_id",control:I,render:({field:t})=>{var i;return e.jsx($,{style:{width:"100%"},placeholder:"Pick position",data:l==null?void 0:l.map(s=>({label:s.name,value:s.id.toString()})),...t,error:(i=m.position_id)==null?void 0:i.message})}})]})]}),e.jsxs(d,{justify:"end",gap:15,mt:20,children:[e.jsx(G,{radius:4,size:"sm",onClick:a,color:"dark",children:"Cancel"}),e.jsx(G,{type:"submit",radius:4,size:"sm",loading:o,disabled:o,color:"blue",children:"Create"})]})]})})}),e.jsx(d,{justify:"end",children:e.jsx(G,{onClick:r,leftSection:e.jsx(Me,{size:16}),children:"Create"})})]})},dr=()=>{const n=ir(),{data:r,isLoading:a}=Be();return e.jsxs(L,{children:[e.jsx(cr,{}),a?e.jsx("div",{children:"table"}):e.jsx(De,{columns:n,data:r})]})},kr=()=>e.jsx(dr,{});export{kr as default};

import{d as D,r as Q,j as e,B as u,F as l,T as h,_ as f}from"./index-BBv3HNww.js";import{A as L,D as M}from"./AlertModal-vX3TRGHT.js";import{u as G,z as b,b as F,a as E,t as I,M as _,C as z,I as N}from"./index-BTdhG7X8.js";import{u as k,a as S}from"./axiosInstance-xGXIEcIh.js";import{u as q}from"./useGetAllDepartments-CgWmRROj.js";import{S as T}from"./Stack-Bz7A2jJH.js";import{T as v}from"./TextInput-BlVSmetB.js";import{S as A}from"./Select-BOtUsB1o.js";import{B as j}from"./Button-CO3L14XQ.js";import{I as $}from"./IconEdit-hB15eExq.js";import{u as U}from"./useGetAllPositions-BFPOW-Vg.js";import{I as W}from"./IconPlus-CVDwImCp.js";const K=s=>{const t=D();return k({mutationFn:async o=>{await S.post(`/positions-update/${s}`,o)},onSuccess:()=>{t.invalidateQueries(["positions"])}})},R=s=>G({queryKey:["department",s],queryFn:async()=>await(await S.get(`/positions/${s}`)).data.position,enabled:!!s}),B=b.object({name:b.string().min(1,"name is required"),department_id:b.string().min(1,"department is required")}),V=({id:s})=>{const[t,{open:o,close:c}]=F(!1),{data:r}=R(s),{data:a}=q(),{mutate:p,isPending:g}=K(s),{register:w,handleSubmit:C,setValue:d,control:P,formState:{errors:y}}=E({resolver:I(B)}),m=n=>{const i=new FormData;for(const x in n)i.append(x,n[x]);p(i,{onSuccess:()=>{c(),f.success("Position updated Successfully.")},onError:()=>{f.error("Something went wrong.")}})};return Q.useEffect(()=>{var n;r&&(d("name",r.name),d("department_id",(n=r.department_id)==null?void 0:n.toString()))},[r,d]),e.jsxs(u,{children:[e.jsx(_,{opened:t,onClose:c,title:"Edit Position Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(u,{my:10,children:e.jsxs("form",{onSubmit:C(m),children:[e.jsxs(T,{children:[e.jsxs(l,{align:"center",gap:"lg",children:[e.jsx(h,{w:130,fw:500,children:"Name"}),e.jsx(v,{style:{width:"100%"},placeholder:"Enter position name",...w("name")})]}),e.jsxs(l,{align:"center",gap:"lg",children:[e.jsx(h,{w:130,fw:500,children:"Department"}),e.jsx(z,{name:"department_id",control:P,render:({field:n})=>{var i;return e.jsx(A,{style:{width:"100%"},placeholder:"Pick department",data:a==null?void 0:a.map(x=>({label:x.name,value:x.id.toString()})),...n,error:(i=y.department_id)==null?void 0:i.message})}})]})]}),e.jsxs(l,{justify:"end",gap:15,mt:20,children:[e.jsx(j,{radius:4,size:"sm",onClick:c,color:"dark",children:"Cancel"}),e.jsx(j,{type:"submit",radius:4,size:"sm",loading:g,disabled:g,color:"blue",children:"Update"})]})]})})}),e.jsx($,{onClick:o,style:{color:"#4361ee",cursor:"pointer"}})]})},H=()=>{const s=D();return k({mutationFn:async t=>await S.delete(`/positions-delete/${t}`),onSuccess:()=>{s.invalidateQueries(["positions "])}})},J=({id:s})=>{const[t,{open:o,close:c}]=F(!1),{mutate:r,isPending:a}=H(),p=()=>{r(s,{onSuccess:()=>{c(),f.success("Position deleted successfully.")}})};return e.jsxs(u,{children:[e.jsx(L,{isLoading:a,title:"Position Delete",description:"This action cannot be undone.",opened:t,close:c,onConfirm:p}),e.jsx(N,{onClick:o,style:{color:"#ef233c",cursor:"pointer"}})]})},O=()=>[{name:"Id",selector:t=>t.id,width:"100px"},{name:"Name",selector:t=>t.name,width:"190px"},{name:"Department",selector:t=>t.department.name,width:"450px"},{name:"Actions",cell:t=>e.jsxs(l,{align:"center",gap:20,children:[e.jsx(V,{id:t.id}),e.jsx(J,{id:t.id})]})}],X=()=>{const s=D();return k({mutationFn:async t=>{await S.post("/position-create",t)},onSuccess:()=>{s.invalidateQueries(["positions"])}})},Y=()=>{var y;const[s,{open:t,close:o}]=F(!1),{mutate:c,isPending:r}=X(),{data:a}=q(),{register:p,handleSubmit:g,reset:w,control:C,formState:{errors:d}}=E({resolver:I(B)}),P=m=>{const n=new FormData;for(const i in m)n.append(i,m[i]);c(n,{onSuccess:()=>{w(),o(),f.success("Department created Successfully.")},onError:()=>{f.error("Something went wrong.")}})};return e.jsxs(u,{children:[e.jsx(_,{opened:s,onClose:o,title:"Create Position Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(u,{my:10,children:e.jsxs("form",{onSubmit:g(P),children:[e.jsxs(T,{children:[e.jsxs(l,{align:"center",gap:"lg",children:[e.jsx(h,{w:130,fw:500,children:"Name"}),e.jsx(v,{style:{width:"100%"},placeholder:"Enter position name",...p("name"),error:(y=d.name)==null?void 0:y.message})]}),e.jsxs(l,{align:"center",gap:"lg",children:[e.jsx(h,{w:130,fw:500,children:"Department"}),e.jsx(z,{name:"department_id",control:C,render:({field:m})=>{var n;return e.jsx(A,{style:{width:"100%"},placeholder:"Pick department",data:a==null?void 0:a.map(i=>({label:i.name,value:i.id.toString()})),...m,error:(n=d.department_id)==null?void 0:n.message})}})]})]}),e.jsxs(l,{justify:"end",gap:15,mt:20,children:[e.jsx(j,{radius:4,size:"sm",onClick:o,color:"dark",children:"Cancel"}),e.jsx(j,{type:"submit",radius:4,size:"sm",loading:r,disabled:r,color:"blue",children:"Create"})]})]})})}),e.jsx(l,{justify:"end",children:e.jsx(j,{onClick:t,leftSection:e.jsx(W,{size:16}),children:"Create"})})]})},Z=()=>{const s=O(),{data:t,isLoading:o}=U();return e.jsxs(u,{children:[e.jsx(Y,{}),o?e.jsx(h,{children:"loading..."}):e.jsx(M,{columns:s,data:t})]})},ue=()=>e.jsx(Z,{});export{ue as default};

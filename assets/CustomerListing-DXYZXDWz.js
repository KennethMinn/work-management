import{d as D,r as N,j as e,B as g,F as t,T as n,_ as E}from"./index-CyrJaVhS.js";import{A as $,D as G}from"./AlertModal-Cc2abRNZ.js";import{z as h,u as W,b as z,a as P,t as L,M as Q,I as K}from"./index-C6klRg22.js";import{u as T,a as F}from"./axiosInstance-DEpY0Rne.js";import{S as M}from"./Stack-DS0nP4Lh.js";import{T as o}from"./TextInput-YpIo0TZ0.js";import{B as _}from"./Button-BujI3Ifw.js";import{I as R}from"./IconEdit-CEWE5dIW.js";import{u as U}from"./useGetAllCustomers-_5r13SHP.js";import{I as V}from"./IconPlus-CFDQgyHZ.js";const v=h.object({name:h.string().min(1,"name is required"),business_type:h.string().min(1,"business type is required"),contact_person:h.string().min(1,"contact person is required"),phone:h.string().min(1,"phone is required"),email:h.string().min(1,"email is required"),address:h.string().min(1,"address is required"),social_link:h.string().min(1,"social link is required")}),H=r=>{const s=D();return T({mutationFn:async l=>{await F.post(`/customers-update/${r}`,l)},onSuccess:()=>{s.invalidateQueries(["customers"])}})},J=r=>W({queryKey:["customer",r],queryFn:async()=>await(await F.get(`/customers/${r}`)).data.customer,enabled:!!r}),O=({id:r})=>{var j,w,y,f,C,b,S;const[s,{open:l,close:p}]=z(!1),{mutate:x,isPending:a}=H(r),{data:i}=J(r),{register:m,handleSubmit:u,reset:q,setValue:c,formState:{errors:d}}=P({resolver:L(v)}),k=I=>{const B=new FormData;for(const A in I)B.append(A,I[A]);x(B,{onSuccess:()=>{q(),p(),E.success("Customer updated Successfully.")},onError:()=>{E.error("Something went wrong.")}})};return N.useEffect(()=>{i&&(c("name",i.name),c("business_type",i.business_type),c("contact_person",i.contact_person),c("phone",i.phone),c("email",i.email),c("address",i.address),c("social_link",i.social_link))},[i,c]),e.jsxs(g,{children:[e.jsx(Q,{opened:s,onClose:p,size:550,padding:30,title:"Create Customer Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(g,{my:10,children:e.jsxs("form",{onSubmit:u(k),children:[e.jsxs(M,{children:[e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Name"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter name",...m("name"),error:(j=d.name)==null?void 0:j.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Business Type"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter business type",...m("business_type"),error:(w=d.business_type)==null?void 0:w.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Contact"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter contact",...m("contact_person"),error:(y=d.contact_person)==null?void 0:y.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Phone"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter phone",...m("phone"),error:(f=d.phone)==null?void 0:f.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Email"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter email",...m("email"),error:(C=d.email)==null?void 0:C.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Address"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter address",...m("address"),error:(b=d.address)==null?void 0:b.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Social Link"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter social link",...m("social_link"),error:(S=d.social_link)==null?void 0:S.message})]})]}),e.jsxs(t,{justify:"end",gap:15,mt:20,children:[e.jsx(_,{radius:4,size:"sm",onClick:p,color:"dark",children:"Cancel"}),e.jsx(_,{type:"submit",radius:4,size:"sm",loading:a,disabled:a,color:"blue",children:"Create"})]})]})})}),e.jsx(R,{onClick:l,style:{color:"#4361ee",cursor:"pointer"}})]})},X=()=>{const r=D();return T({mutationFn:async s=>await F.delete(`/customers-delete/${s}`),onSuccess:()=>{r.invalidateQueries(["customers"])}})},Y=({id:r})=>{const[s,{open:l,close:p}]=z(!1),{mutate:x,isPending:a}=X(),i=()=>{x(r,{onSuccess:()=>{p(),E.success("Customer deleted successfully.")}})};return e.jsxs(g,{children:[e.jsx($,{isLoading:a,title:"Customer Delete",description:"This action cannot be undone.",opened:s,close:p,onConfirm:i}),e.jsx(K,{onClick:l,style:{color:"#ef233c",cursor:"pointer"}})]})},Z=()=>[{name:"Id",selector:s=>s.id,width:"100px"},{name:"Name",selector:s=>s.name,width:"150px"},{name:"Business Type",selector:s=>s.business_type,width:"150px"},{name:"Contact",selector:s=>s.contact_person,width:"150px"},{name:"Phone",selector:s=>s.phone,width:"150px"},{name:"Email",selector:s=>s.email,width:"200px"},{name:"Address",selector:s=>s.address,width:"100px"},{name:"Social",selector:s=>s.social_link,width:"160px"},{name:"Actions",cell:s=>e.jsxs(t,{align:"center",gap:20,children:[e.jsx(O,{id:s.id}),e.jsx(Y,{id:s.id})]})}],ee=()=>{const r=D();return T({mutationFn:async s=>{await F.post("/customer-create",s)},onSuccess:()=>{r.invalidateQueries(["customers"])}})},se=()=>{var c,d,k,j,w,y,f;const[r,{open:s,close:l}]=z(!1),{mutate:p,isPending:x}=ee(),{register:a,handleSubmit:i,reset:m,formState:{errors:u}}=P({resolver:L(v)}),q=C=>{const b=new FormData;for(const S in C)b.append(S,C[S]);p(b,{onSuccess:()=>{m(),l(),E.success("Customer created Successfully.")},onError:()=>{E.error("Something went wrong.")}})};return e.jsxs(g,{children:[e.jsx(Q,{opened:r,onClose:l,size:550,padding:30,title:"Create Customer Form",centered:!0,styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsx(g,{my:10,children:e.jsxs("form",{onSubmit:i(q),children:[e.jsxs(M,{children:[e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Name"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter name",...a("name"),error:(c=u.name)==null?void 0:c.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Business Type"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter business type",...a("business_type"),error:(d=u.business_type)==null?void 0:d.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Contact"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter contact",...a("contact_person"),error:(k=u.contact_person)==null?void 0:k.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Phone"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter phone",...a("phone"),error:(j=u.phone)==null?void 0:j.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Email"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter email",...a("email"),error:(w=u.email)==null?void 0:w.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Address"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter address",...a("address"),error:(y=u.address)==null?void 0:y.message})]}),e.jsxs(t,{align:"center",gap:"lg",children:[e.jsx(n,{w:180,fw:500,children:"Social Link"}),e.jsx(o,{style:{width:"100%"},placeholder:"Enter social link",...a("social_link"),error:(f=u.social_link)==null?void 0:f.message})]})]}),e.jsxs(t,{justify:"end",gap:15,mt:20,children:[e.jsx(_,{radius:4,size:"sm",onClick:l,color:"dark",children:"Cancel"}),e.jsx(_,{type:"submit",radius:4,size:"sm",loading:x,disabled:x,color:"blue",children:"Create"})]})]})})}),e.jsx(t,{justify:"end",children:e.jsx(_,{onClick:s,leftSection:e.jsx(V,{size:16}),children:"Create"})})]})},re=()=>{const r=Z(),{data:s,isLoading:l}=U();return e.jsxs(g,{children:[e.jsx(se,{}),l?e.jsx(n,{children:"loading..."}):e.jsx(G,{columns:r,data:s})]})},pe=()=>e.jsx(re,{});export{pe as default};
